--Project Overview

--Project Title: Sales Data Analysis

--Description: This project involves the analysis of sales data from a fictional retail company. The objective is to extract insights and generate reports that can help in making business decisions.

--Create Database
CREATE DATABASE RetailDB;

--Use the database
USE RetailDB;

--Create Tables
CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(100),
    ContactName VARCHAR(100),
    Country VARCHAR(50)
);

CREATE TABLE Categories (
    CategoryID INT PRIMARY KEY,
    CategoryName VARCHAR(100)
);

CREATE TABLE Products (
    ProductID INT PRIMARY KEY,
    ProductName VARCHAR(100),
    SupplierID INT,
    CategoryID INT,
    Unit VARCHAR(50),
    Price DECIMAL(10, 2),
    FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
);

CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    EmployeeID INT,
    OrderDate DATE,
    ShipperID INT,
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

CREATE TABLE OrderDetails (
    OrderDetailID INT PRIMARY KEY,
    OrderID INT,
    ProductID INT,
    Quantity INT,
    FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

--Sample Data

--Insert sample data into Customers table
INSERT INTO Customers (CustomerID, CustomerName, ContactName, Country) VALUES
(1, 'John Doe', 'John', 'USA'),
(2, 'Jane Smith', 'Jane', 'UK'),
(3, 'Michael Brown', 'Michael', 'Canada');

--Insert sample data into Categories table
INSERT INTO Categories (CategoryID, CategoryName) VALUES
(1, 'Beverages'),
(2, 'Condiments');

--Insert sample data into Products table
INSERT INTO Products (ProductID, ProductName, SupplierID, CategoryID, Unit, Price) VALUES
(1, 'Chai', 1, 1, '10 boxes x 20 bags', 18.00),
(2, 'Chang', 1, 1, '24 - 12 oz bottles', 19.00);

--Insert sample data into Orders table
INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) VALUES
(1, 1, 1, '2024-01-15', 1),
(2, 2, 2, '2024-02-18', 2);

--Insert sample data into OrderDetails table
INSERT INTO OrderDetails (OrderDetailID, OrderID, ProductID, Quantity) VALUES
(1, 1, 1, 10),
(2, 1, 2, 20),
(3, 2, 1, 30);

--Basic SQL Queries

--Select all customers
SELECT * FROM Customers;

--Select all products
SELECT * FROM Products;

--Some Complex Queries

--Join Orders and Customers to get customer names for each order
SELECT Orders.OrderID, Customers.CustomerName, Orders.OrderDate
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID;

--Get total sales per product
SELECT Products.ProductName, SUM(OrderDetails.Quantity) AS TotalQuantity
FROM OrderDetails
JOIN Products ON OrderDetails.ProductID = Products.ProductID
GROUP BY Products.ProductName;

--Stored Procedures

--Stored procedure to get order details by customer
DELIMITER //
CREATE PROCEDURE GetOrderDetailsByCustomer(IN customerId INT)
BEGIN
    SELECT Orders.OrderID, Products.ProductName, OrderDetails.Quantity
    FROM Orders
    JOIN OrderDetails ON Orders.OrderID = OrderDetails.OrderID
    JOIN Products ON OrderDetails.ProductID = Products.ProductID
    WHERE Orders.CustomerID = customerId;
END //
DELIMITER ;
